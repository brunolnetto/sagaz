============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0 -- /home/pingu/github/sagaz/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/pingu/github/sagaz
configfile: pyproject.toml
testpaths: tests
plugins: xdist-3.8.0, cov-7.0.0, anyio-4.12.1, timeout-2.4.0, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 1697 items / 81 deselected / 1 skipped / 1616 selected

tests/integration/test_api_protection.py::TestDeclarativeMode::test_run_works_on_declarative_saga PASSED [  0%]
tests/integration/test_api_protection.py::TestDeclarativeMode::test_mode_is_declarative PASSED [  0%]
tests/integration/test_api_protection.py::TestDeclarativeMode::test_add_step_raises_on_declarative_saga PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_add_step_works_on_fresh_saga PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_mode_is_imperative_after_add_step PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_add_step_returns_self_for_chaining PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_method_chaining_works PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_run_works_on_imperative_saga PASSED [  0%]
tests/integration/test_api_protection.py::TestImperativeMode::test_duplicate_step_name_raises_error PASSED [  0%]
tests/integration/test_api_protection.py::TestModeMixingPrevention::test_cannot_add_step_to_decorated_saga PASSED [  0%]
tests/integration/test_api_protection.py::TestErrorMessages::test_add_step_error_explains_alternatives PASSED [  0%]
tests/integration/test_api_protection.py::TestBackwardCompatibility::test_declarative_saga_works PASSED [  0%]
tests/integration/test_api_protection.py::TestBackwardCompatibility::test_saga_name_from_class_attribute PASSED [  0%]
tests/integration/test_api_protection.py::TestBackwardCompatibility::test_saga_name_from_constructor PASSED [  0%]
tests/integration/test_chaos_engineering.py::TestWorkerCrashRecovery::test_worker_crash_mid_publish_another_picks_up PASSED [  0%]
tests/integration/test_chaos_engineering.py::TestWorkerCrashRecovery::test_worker_graceful_shutdown_preserves_state PASSED [  0%]
tests/integration/test_chaos_engineering.py::TestWorkerCrashRecovery::test_multiple_workers_no_duplicate_processing PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestDatabaseConnectionLoss::test_database_connection_loss_during_saga_execution PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestDatabaseConnectionLoss::test_outbox_storage_connection_retry PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestDatabaseConnectionLoss::test_connection_pool_exhaustion_recovery PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestBrokerDowntime::test_partial_batch_failure PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestNetworkPartitions::test_split_brain_prevention PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestNetworkPartitions::test_delayed_acknowledgment PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestConcurrentFailures::test_database_and_broker_both_fail PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestConcurrentFailures::test_high_load_degradation PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestDataConsistency::test_no_data_loss_under_failures PASSED [  1%]
tests/integration/test_chaos_engineering.py::TestDataConsistency::test_exactly_once_processing_guarantee PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaSnapshotCapture::test_snapshot_capture_before_each_step PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaSnapshotCapture::test_snapshot_capture_after_each_step PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaSnapshotCapture::test_snapshot_disabled_by_default PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaReplayIntegration::test_replay_from_step2_after_step1_failure PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaReplayIntegration::test_resume_with_context_override PASSED [  1%]
tests/integration/test_saga_replay_integration.py::TestSagaReplayIntegration::test_replay_skips_completed_steps PASSED [  2%]
tests/integration/test_saga_replay_integration.py::TestReplayErrorHandling::test_replay_without_saga_factory_requires_dry_run PASSED [  2%]
tests/integration/test_saga_replay_integration.py::TestReplayErrorHandling::test_replay_marks_failure_when_saga_fails PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExamplesDir::test_returns_path PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExamplesDir::test_path_ends_with_examples PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetCategories::test_returns_list PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetCategories::test_returns_sorted_categories PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetCategories::test_empty_when_dir_not_exists PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestDiscoverExamples::test_returns_dict PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestDiscoverExamples::test_category_filter PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestDiscoverExamples::test_empty_when_dir_not_exists PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestDiscoverExamples::test_category_not_found PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExampleDescription::test_returns_string PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExampleDescription::test_extracts_docstring PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExampleDescription::test_no_docstring PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExampleDescription::test_empty_docstring PASSED [  2%]
tests/unit/cli/test_cli_examples.py::TestGetExampleDescription::test_file_not_found PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestListExamplesCmd::test_no_examples_found PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestListExamplesCmd::test_examples_listed PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestListExamplesCmd::test_category_filter_message PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestRunExampleCmd::test_example_not_found PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestRunExampleCmd::test_example_executed PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestExecuteExample::test_runs_subprocess PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestExecuteExample::test_handles_subprocess_error PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestExecuteExample::test_handles_keyboard_interrupt PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestInteractiveCmd::test_no_examples_found PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestInteractiveCmd::test_uses_fallback_when_no_term_menu PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestInteractiveCmd::test_uses_term_menu_when_available PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestInteractiveCmd::test_uses_examples_menu_with_category PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestFallbackInteractive::test_quit_option PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestFallbackInteractive::test_selects_example PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestFallbackInteractive::test_invalid_number PASSED [  3%]
tests/unit/cli/test_cli_examples.py::TestFallbackInteractive::test_value_error PASSED [  4%]
tests/unit/cli/test_cli_examples.py::TestFallbackInteractive::test_no_examples PASSED [  4%]
tests/unit/cli/test_cli_examples_coverage.py::test_list_examples_no_console PASSED [  4%]
tests/unit/cli/test_cli_examples_coverage.py::test_execute_example_pythonpath PASSED [  4%]
tests/unit/cli/test_cli_examples_coverage.py::test_execute_example_extending_pythonpath PASSED [  4%]
tests/unit/cli/test_project.py::test_init_creates_scaffold PASSED        [  4%]
tests/unit/cli/test_project.py::test_init_fails_if_dir_exists_and_not_empty PASSED [  4%]
tests/unit/cli/test_project.py::test_check_fails_without_sagaz_yaml PASSED [  4%]
tests/unit/cli/test_project.py::test_check_validates_project PASSED      [  4%]
tests/unit/cli/test_project.py::test_list_sagas PASSED                   [  4%]
tests/unit/cli/test_project.py::test_check_warns_missing_paths PASSED    [  4%]
tests/unit/cli/test_replay.py::TestReplayCommandGroup::test_replay_group_exists PASSED [  4%]
tests/unit/cli/test_replay.py::TestReplayCommandGroup::test_replay_group_has_subcommands PASSED [  4%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_requires_saga_id PASSED [  4%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_requires_from_step PASSED [  4%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_invalid_saga_id PASSED [  4%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_invalid_override_format PASSED [  5%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_valid_override PASSED [  5%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_dry_run PASSED [  5%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_verbose_mode PASSED [  5%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_failed_replay PASSED [  5%]
tests/unit/cli/test_replay.py::TestReplayCommand::test_replay_command_exception_handling PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_requires_saga_id PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_requires_timestamp PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_invalid_saga_id PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_invalid_timestamp PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_query_state_not_found PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_query_specific_key_not_found PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_query_specific_key_found PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_json_format PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_full_state_text_format PASSED [  5%]
tests/unit/cli/test_replay.py::TestTimeTravelCommand::test_time_travel_exception_handling PASSED [  5%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_requires_saga_id PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_invalid_saga_id PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_invalid_after_timestamp PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_invalid_before_timestamp PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_no_changes_found PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_with_results PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_with_time_filters PASSED [  6%]
tests/unit/cli/test_replay.py::TestListChangesCommand::test_list_changes_exception_handling PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteReplay::test_execute_replay_basic PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteReplay::test_execute_replay_not_implemented_storage PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteTimeTravel::test_execute_time_travel_key_found PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteTimeTravel::test_execute_time_travel_key_not_found PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteTimeTravel::test_execute_time_travel_not_implemented_storage PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteListChanges::test_execute_list_changes_no_results PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteListChanges::test_execute_list_changes_with_results PASSED [  6%]
tests/unit/cli/test_replay.py::TestExecuteListChanges::test_execute_list_changes_not_implemented_storage PASSED [  6%]
tests/unit/cli/test_replay.py::TestStorageTypeValidation::test_replay_accepts_valid_storage_types PASSED [  6%]
tests/unit/cli/test_replay.py::TestStorageTypeValidation::test_time_travel_accepts_valid_storage_types PASSED [  7%]
tests/unit/cli/test_replay.py::TestStorageTypeValidation::test_list_changes_accepts_valid_storage_types PASSED [  7%]
tests/unit/cli/test_replay.py::TestRichConsoleOutput::test_replay_verbose_with_rich PASSED [  7%]
tests/unit/cli/test_replay.py::TestRichConsoleOutput::test_time_travel_with_json_format PASSED [  7%]
tests/unit/cli/test_replay.py::TestRichConsoleOutput::test_time_travel_with_table_format_no_rich PASSED [  7%]
tests/unit/cli/test_replay.py::TestWithoutRich::test_replay_command_without_rich PASSED [  7%]
tests/unit/cli/test_replay.py::TestWithoutRich::test_replay_verbose_without_rich PASSED [  7%]
tests/unit/cli/test_replay.py::TestWithoutRich::test_list_changes_without_rich PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestCompensationNode::test_create_basic_node PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestCompensationNode::test_create_node_with_dependencies PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestCompensationType::test_compensation_types PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_register_compensation PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_register_compensation_with_options PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_mark_step_executed PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_mark_step_executed_idempotent PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_unmark_step_executed PASSED [  7%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_get_executed_steps PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_compensation_order_simple PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_compensation_order_parallel PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_compensation_order_only_executed_steps PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_compensation_order_empty PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_compensation_order_complex_dag PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_validate_success PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_validate_missing_dependency PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_validate_circular_dependency PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_get_compensation_info PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_clear PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_reset_execution PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestSagaExecutionGraph::test_repr PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestCircularDependencyError::test_error_message PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestMissingDependencyError::test_error_message PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestCompensationResult::test_create_success_result PASSED [  8%]
tests/unit/core/test_compensation_graph.py::TestCompensationResult::test_create_failure_result PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestCompensationFailureStrategy::test_all_strategies_exist PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestCompensationResultPassing::test_compensation_with_return_value PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestCompensationResultPassing::test_compensation_result_passing_between_steps PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestCompensationResultPassing::test_backward_compatibility_old_signature PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestCompensationResultPassing::test_mixed_old_and_new_signatures PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestFailureStrategies::test_fail_fast_strategy PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestFailureStrategies::test_continue_on_error_strategy PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestFailureStrategies::test_retry_then_continue_strategy PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestFailureStrategies::test_skip_dependents_strategy PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_empty_graph PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_no_executed_steps PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_circular_dependency_returns_error PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_timeout_handling PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_parallel_execution_in_level PASSED [  9%]
tests/unit/core/test_compensation_graph.py::TestExecuteCompensationsEdgeCases::test_execution_time_tracking PASSED [  9%]
tests/unit/core/test_compliance.py::TestComplianceConfig::test_default_config PASSED [ 10%]
tests/unit/core/test_compliance.py::TestComplianceConfig::test_custom_config PASSED [ 10%]
tests/unit/core/test_compliance.py::TestEncryption::test_encrypt_sensitive_fields PASSED [ 10%]
tests/unit/core/test_compliance.py::TestEncryption::test_decrypt_context PASSED [ 10%]
tests/unit/core/test_compliance.py::TestEncryption::test_encryption_disabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestEncryption::test_identify_sensitive_fields PASSED [ 10%]
tests/unit/core/test_compliance.py::TestAccessControl::test_access_control_disabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestAccessControl::test_access_control_enabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestAuditTrail::test_create_audit_log PASSED [ 10%]
tests/unit/core/test_compliance.py::TestAuditTrail::test_audit_trail_disabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestGDPRCompliance::test_delete_user_data_requires_gdpr_enabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestGDPRCompliance::test_delete_user_data_gdpr_enabled PASSED [ 10%]
tests/unit/core/test_compliance.py::TestGDPRCompliance::test_anonymize_context PASSED [ 10%]
tests/unit/core/test_compliance.py::TestComplianceIntegration::test_encrypt_decrypt_round_trip PASSED [ 10%]
tests/unit/core/test_compliance.py::TestComplianceIntegration::test_audit_trail_for_replay_operations PASSED [ 10%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_fs_storage_invalid_uri_load PASSED [ 10%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_fs_storage_file_not_found PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_fs_storage_invalid_uri_delete PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_fs_storage_delete_non_existent PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_set_async_without_offload PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_async_stream PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_async_ref_load_fallback PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_async_default PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_store_external_no_backend PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_load_external_no_backend PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_load_external_key_not_found PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_should_offload_exception PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_estimate_size_bytes PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_estimate_size_pickle PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_estimate_size_str PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_set_sync_stream PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_set_async_stream PASSED [ 11%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_sync_stream PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_stream_access PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_has_checks PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_set_sync_normal PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_sync_normal PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_set_async_offload PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_get_async_external_ref PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_load_external_marker_direct PASSED [ 12%]
tests/unit/core/test_context_coverage.py::TestContextCoverage::test_should_offload_logic PASSED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_store_calls_put_object SKIPPED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_load_calls_get_object SKIPPED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_load_wrong_bucket_raises_error SKIPPED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_load_invalid_scheme_raises_error SKIPPED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_delete_calls_delete_object SKIPPED [ 12%]
tests/unit/core/test_context_s3.py::TestS3Storage::test_delete_ignores_invalid_and_wrong_bucket SKIPPED [ 12%]
tests/unit/core/test_context_s3_coverage.py::test_init_raises_if_missing_aioboto3 PASSED [ 12%]
tests/unit/core/test_context_s3_coverage.py::TestS3MalformedURIs::test_load_malformed_uri SKIPPED [ 12%]
tests/unit/core/test_context_s3_coverage.py::TestS3MalformedURIs::test_delete_malformed_uri_ignored SKIPPED [ 13%]
tests/unit/core/test_context_s3_coverage.py::TestS3Errors::test_load_nosuchkey_raises_filenotfound SKIPPED [ 13%]
tests/unit/core/test_context_s3_coverage.py::TestS3Errors::test_load_other_error_raises SKIPPED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_external_storage_manual PASSED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_auto_offload PASSED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_streaming_generator PASSED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_mixed_access_patterns PASSED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_filesystem_storage_invalid_uri PASSED [ 13%]
tests/unit/core/test_context_streaming.py::TestContextStreaming::test_filesystem_storage_delete PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestConfigurationValidation::test_auto_offload_without_storage_raises_error PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestConfigurationValidation::test_auto_offload_with_storage_succeeds PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestConfigurationValidation::test_storage_without_auto_offload_succeeds PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestConfigurationValidation::test_default_configuration PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestWarningSystem::test_large_payload_emits_warning PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestWarningSystem::test_small_payload_no_warning PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestWarningSystem::test_warnings_disabled PASSED [ 13%]
tests/unit/core/test_context_validation.py::TestStrictMode::test_strict_limit_raises_error PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestStrictMode::test_strict_limit_allows_small_values PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestStrictMode::test_no_strict_limit_by_default PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestAutoOffloadBehavior::test_auto_offload_stores_externally PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestAutoOffloadBehavior::test_auto_offload_keeps_small_values_in_memory PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestAutoOffloadBehavior::test_strict_limit_takes_precedence_over_auto_offload PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestPriorityOrder::test_all_features_enabled_priority PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestEdgeCases::test_size_estimation_failure_stores_normally PASSED [ 14%]
tests/unit/core/test_context_validation.py::TestEdgeCases::test_async_generator_bypasses_validation PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_saga_initialization PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_add_step_basic PASSED   [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_add_step_with_options PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_cannot_add_steps_during_execution PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_successful_execution_single_step PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_successful_execution_multiple_steps PASSED [ 14%]
tests/unit/core/test_core.py::TestCoreSaga::test_execution_order PASSED  [ 14%]
tests/unit/core/test_core.py::TestSagaContext::test_context_set_get PASSED [ 15%]
tests/unit/core/test_core.py::TestSagaContext::test_context_get_default PASSED [ 15%]
tests/unit/core/test_core.py::TestSagaContext::test_context_has PASSED   [ 15%]
tests/unit/core/test_core.py::TestSagaContext::test_context_passed_between_steps PASSED [ 15%]
tests/unit/core/test_core.py::TestFailureAndCompensation::test_step_failure_triggers_compensation PASSED [ 15%]
tests/unit/core/test_core.py::TestFailureAndCompensation::test_compensation_in_reverse_order PASSED [ 15%]
tests/unit/core/test_core.py::TestFailureAndCompensation::test_compensation_failure_changes_status PASSED [ 15%]
tests/unit/core/test_core.py::TestFailureAndCompensation::test_partial_compensation_failure PASSED [ 15%]
tests/unit/core/test_core.py::TestFailureAndCompensation::test_step_without_compensation PASSED [ 15%]
tests/unit/core/test_core.py::TestRetryLogic::test_step_retries_on_failure PASSED [ 15%]
tests/unit/core/test_core.py::TestRetryLogic::test_step_retry_exhaustion PASSED [ 15%]
tests/unit/core/test_core.py::TestRetryLogic::test_retry_with_exponential_backoff PASSED [ 15%]
tests/unit/core/test_core.py::TestRetryLogic::test_configurable_retry_backoff_base PASSED [ 15%]
tests/unit/core/test_core.py::TestRetryLogic::test_successful_step_no_retry PASSED [ 15%]
tests/unit/core/test_core.py::TestTimeouts::test_step_timeout PASSED     [ 15%]
tests/unit/core/test_core.py::TestTimeouts::test_compensation_timeout PASSED [ 15%]
tests/unit/core/test_core.py::TestTimeouts::test_fast_step_no_timeout PASSED [ 16%]
tests/unit/core/test_core.py::TestIdempotency::test_idempotency_key_prevents_duplicate PASSED [ 16%]
tests/unit/core/test_core.py::TestIdempotency::test_different_keys_allow_execution PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_initial_state_pending PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_transition_to_executing PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_transition_to_completed PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_transition_to_compensating_then_rolled_back PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_empty_saga_succeeds PASSED [ 16%]
tests/unit/core/test_core.py::TestStateMachine::test_timestamps_recorded PASSED [ 16%]
tests/unit/core/test_core.py::TestOrchestrator::test_orchestrator_tracks_sagas PASSED [ 16%]
tests/unit/core/test_core.py::TestOrchestrator::test_orchestrator_get_saga PASSED [ 16%]
tests/unit/core/test_core.py::TestOrchestrator::test_orchestrator_get_nonexistent_saga PASSED [ 16%]
tests/unit/core/test_core.py::TestOrchestrator::test_orchestrator_count_by_status PASSED [ 16%]
tests/unit/core/test_core.py::TestOrchestrator::test_orchestrator_statistics PASSED [ 16%]
tests/unit/core/test_core.py::TestSaga::test_dag_saga_initialization PASSED [ 16%]
tests/unit/core/test_core.py::TestSaga::test_add_dag_step_without_dependencies PASSED [ 16%]
tests/unit/core/test_core.py::TestSaga::test_add_dag_step_with_dependencies PASSED [ 17%]
tests/unit/core/test_core.py::TestSaga::test_invalid_dependency_raises_error PASSED [ 17%]
tests/unit/core/test_core.py::TestSaga::test_compute_execution_order PASSED [ 17%]
tests/unit/core/test_core.py::TestSaga::test_circular_dependency_detected PASSED [ 17%]
tests/unit/core/test_core.py::TestSaga::test_parallel_execution_faster_than_sequential PASSED [ 17%]
tests/unit/core/test_core.py::TestParallelFailureStrategies::test_fail_fast_cancels_other_tasks PASSED [ 17%]
tests/unit/core/test_core.py::TestParallelFailureStrategies::test_wait_all_lets_all_finish PASSED [ 17%]
tests/unit/core/test_core.py::TestParallelFailureStrategies::test_fail_fast_grace_waits_for_inflight PASSED [ 17%]
tests/unit/core/test_core.py::TestDAGCompensation::test_dag_compensation_in_reverse_topological_order PASSED [ 17%]
tests/unit/core/test_core.py::TestDAGCompensation::test_dag_parallel_compensation PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaSequential::test_sequential_saga_basic PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaSequential::test_sequential_saga_with_compensation PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaParallel::test_parallel_saga_basic PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaParallel::test_dag_with_dependencies PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaParallel::test_parallel_failure_strategies PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaMixed::test_mixed_sequential_parallel PASSED [ 17%]
tests/unit/core/test_core.py::TestSagaEdgeCases::test_empty_saga PASSED  [ 18%]
tests/unit/core/test_core.py::TestSagaEdgeCases::test_duplicate_step_names PASSED [ 18%]
tests/unit/core/test_core.py::TestSagaEdgeCases::test_circular_dependencies PASSED [ 18%]
tests/unit/core/test_core.py::TestSagaEdgeCases::test_missing_dependencies PASSED [ 18%]
tests/unit/core/test_core.py::TestSagaEdgeCases::test_strategy_switching PASSED [ 18%]
tests/unit/core/test_core.py::TestSagaIntegration::test_ecommerce_order_processing PASSED [ 18%]
tests/unit/core/test_core.py::TestSagaIntegration::test_financial_trade_execution PASSED [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_empty_saga_completes_successfully PASSED [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_saga_can_be_executed_multiple_times PASSED [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_very_long_saga PASSED  [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_saga_with_complex_data_in_context PASSED [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_exception_in_compensation_doesnt_stop_other_compensations PASSED [ 18%]
tests/unit/core/test_core.py::TestEdgeCases::test_null_and_none_handling PASSED [ 18%]
tests/unit/core/test_core.py::TestConcurrency::test_concurrent_saga_execution_protected PASSED [ 18%]
tests/unit/core/test_core.py::TestConcurrency::test_multiple_sagas_execute_concurrently PASSED [ 18%]
tests/unit/core/test_core.py::TestConcurrency::test_orchestrator_handles_concurrent_submissions PASSED [ 18%]
tests/unit/core/test_core.py::TestPerformance::test_execution_time_recorded PASSED [ 18%]
tests/unit/core/test_core.py::TestPerformance::test_overhead_is_minimal PASSED [ 19%]
tests/unit/core/test_core.py::TestPerformance::test_memory_efficient_context PASSED [ 19%]
tests/unit/core/test_core.py::TestIntegration::test_complete_ecommerce_flow PASSED [ 19%]
tests/unit/core/test_core.py::TestIntegration::test_complete_ecommerce_flow_with_failure PASSED [ 19%]
tests/unit/core/test_core.py::TestIntegration::test_orchestrator_with_multiple_saga_types PASSED [ 19%]
tests/unit/core/test_core.py::TestRealWorldScenarios::test_microservice_timeout_recovery PASSED [ 19%]
tests/unit/core/test_core.py::TestRealWorldScenarios::test_partial_success_with_compensation PASSED [ 19%]
tests/unit/core/test_core.py::TestRealWorldScenarios::test_idempotent_external_api_calls PASSED [ 19%]
tests/unit/core/test_core.py::TestSagaHelperMethods::test_saga_name_property PASSED [ 19%]
tests/unit/core/test_core.py::TestSagaHelperMethods::test_set_failure_strategy PASSED [ 19%]
tests/unit/core/test_core.py::TestSagaHelperMethods::test_saga_step_name_property PASSED [ 19%]
tests/unit/core/test_core.py::TestSagaResultProperties::test_is_completed_property PASSED [ 19%]
tests/unit/core/test_core.py::TestSagaResultProperties::test_is_rolled_back_property PASSED [ 19%]
tests/unit/core/test_core.py::TestStepWithoutCompensation::test_step_without_compensation_execute PASSED [ 19%]
tests/unit/core/test_core.py::TestStepWithoutCompensation::test_step_without_compensation_no_rollback_needed PASSED [ 19%]
tests/unit/core/test_core.py::TestStepExecutor::test_step_executor_compensate_no_compensation PASSED [ 19%]
tests/unit/core/test_core.py::TestStepExecutor::test_step_executor_compensate_with_compensation PASSED [ 20%]
tests/unit/core/test_core.py::TestStepExecutor::test_step_executor_name_property PASSED [ 20%]
tests/unit/core/test_core.py::TestBuildExecutionBatches::test_circular_dependency_detection PASSED [ 20%]
tests/unit/core/test_core.py::TestBuildExecutionBatches::test_missing_dependency_detection PASSED [ 20%]
tests/unit/core/test_core.py::TestDAGExceptionHandling::test_dag_execution_unexpected_exception PASSED [ 20%]
tests/unit/core/test_core.py::TestSagaStepHash::test_saga_step_hash PASSED [ 20%]
tests/unit/core/test_core.py::TestSagaAlreadyExecuting::test_saga_already_executing_error PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestSerializationEdgeCases::test_storage_decoder_enum_type PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestSerializationEdgeCases::test_storage_decoder_unknown_type PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestSerializationEdgeCases::test_storage_decoder_no_type_key PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestSerializationEdgeCases::test_storage_encoder_with_dict_object PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestConnectionManagerEdgeCases::test_initialize_already_initialized PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestConnectionManagerEdgeCases::test_acquire_without_connection PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestConnectionManagerEdgeCases::test_acquire_with_invalid_connection PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestConnectionManagerEdgeCases::test_health_check_valid_connection PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestTransferServiceEdgeCases::test_transfer_with_skip_on_error PASSED [ 20%]
tests/unit/core/test_coverage_edge_cases.py::TestTransferServiceEdgeCases::test_transfer_with_retry_success PASSED [ 21%]
tests/unit/core/test_coverage_edge_cases.py::TestStorageManagerEdgeCases::test_normalize_health_result_with_to_dict PASSED [ 21%]
tests/unit/core/test_coverage_edge_cases.py::TestStorageManagerEdgeCases::test_normalize_health_result_with_status_attr PASSED [ 21%]
tests/unit/core/test_coverage_edge_cases.py::TestStorageManagerEdgeCases::test_normalize_health_result_with_dict PASSED [ 21%]
tests/unit/core/test_coverage_edge_cases.py::TestStorageManagerEdgeCases::test_normalize_health_result_fallback PASSED [ 21%]
tests/unit/core/test_decorators.py::TestStepDecorator::test_step_decorator_basic PASSED [ 21%]
tests/unit/core/test_decorators.py::TestStepDecorator::test_step_decorator_with_all_options PASSED [ 21%]
tests/unit/core/test_decorators.py::TestStepDecorator::test_decorated_function_still_callable PASSED [ 21%]
tests/unit/core/test_decorators.py::TestCompensateDecorator::test_compensate_decorator_basic PASSED [ 21%]
tests/unit/core/test_decorators.py::TestCompensateDecorator::test_compensate_decorator_with_all_options PASSED [ 21%]
tests/unit/core/test_decorators.py::TestCompensateDecorator::test_decorated_function_still_callable PASSED [ 21%]
tests/unit/core/test_decorators.py::TestSagaStepDefinition::test_create_basic_definition PASSED [ 21%]
tests/unit/core/test_decorators.py::TestSaga::test_collect_steps PASSED  [ 21%]
tests/unit/core/test_decorators.py::TestSaga::test_collect_compensations PASSED [ 21%]
tests/unit/core/test_decorators.py::TestSaga::test_get_steps PASSED      [ 21%]
tests/unit/core/test_decorators.py::TestSaga::test_get_step PASSED       [ 21%]
tests/unit/core/test_decorators.py::TestSaga::test_get_execution_order_simple PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_get_execution_order_parallel PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_get_execution_order_empty PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_run_success PASSED    [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_run_with_compensation_on_failure PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_run_with_timeout PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_run_parallel_execution PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSaga::test_repr PASSED           [ 22%]
tests/unit/core/test_decorators.py::TestSagaAdvanced::test_compensation_order_respected PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSagaAdvanced::test_compensation_continues_on_error PASSED [ 22%]
tests/unit/core/test_decorators.py::TestSagaAdvanced::test_saga_with_custom_id PASSED [ 22%]
tests/unit/core/test_decorators.py::TestImperativeSupport::test_add_step_programmatically PASSED [ 22%]
tests/unit/core/test_decorators.py::TestImperativeSupport::test_mix_declarative_and_imperative PASSED [ 22%]
tests/unit/core/test_edge_cases.py::TestCompensationGraphTo100::test_compensation_graph_validation_circular PASSED [ 22%]
tests/unit/core/test_edge_cases.py::TestCompensationGraphTo100::test_compensation_graph_find_cycle_deep PASSED [ 22%]
tests/unit/core/test_edge_cases.py::TestCoreTo100::test_saga_no_completed_steps_compensation_attempt PASSED [ 22%]
tests/unit/core/test_edge_cases.py::TestCoreTo100::test_saga_already_executing_error PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestDecoratorsTo100::test_saga_execution_order_circular_dependency PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestDecoratorsTo100::test_saga_compensation_error_handling PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestStateMachineTo100::test_state_machine_transitions PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestStorageTo100::test_memory_storage_list_sagas_pagination PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestStorageTo100::test_postgresql_storage_import_error PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestStorageTo100::test_redis_storage_import_error PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestBrokerTo100::test_kafka_broker_import_check PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestBrokerTo100::test_rabbitmq_broker_import_check PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestBrokerTo100::test_broker_factory_print_output PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestOrchestratorTo100::test_orchestrator_verbose_logging PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestMonitoringTo100::test_tracing_without_opentelemetry PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestMonitoringTo100::test_metrics_record_execution PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestWorkerTo100::test_worker_signal_handlers PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestOutboxTypesTo100::test_outbox_event_str_payload PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestOutboxTypesTo100::test_outbox_config_from_env PASSED [ 23%]
tests/unit/core/test_edge_cases.py::TestStrategiesTo100::test_fail_fast_cancellation PASSED [ 24%]
tests/unit/core/test_edge_cases.py::TestStrategiesTo100::test_fail_fast_grace_timeout_path PASSED [ 24%]
tests/unit/core/test_edge_cases.py::TestOutboxMemoryTo100::test_memory_outbox_insert_and_claim PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksBasic::test_on_enter_called_before_step_execution PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksBasic::test_on_success_called_after_successful_step PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksBasic::test_on_failure_called_when_step_fails PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksBasic::test_on_compensate_called_during_compensation PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksWithOutbox::test_publish_event_on_success PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksWithOutbox::test_publish_event_on_failure PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksMultiple::test_all_hooks_on_successful_step PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksMultiple::test_all_hooks_on_failed_step PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksSyncSupport::test_sync_hook_is_supported PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksErrorHandling::test_hook_error_does_not_break_saga PASSED [ 24%]
tests/unit/core/test_hooks.py::TestStepHooksErrorHandling::test_on_success_error_does_not_hide_result PASSED [ 24%]
tests/unit/core/test_hooks.py::TestHookHelperDecorators::test_on_step_enter_decorator PASSED [ 24%]
tests/unit/core/test_hooks.py::TestHookHelperDecorators::test_publish_on_success_helper PASSED [ 24%]
tests/unit/core/test_hooks_listeners.py::TestHookDecorators::test_on_step_enter_is_passthrough PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestHookDecorators::test_on_step_success_is_passthrough PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestHookDecorators::test_on_step_failure_is_passthrough PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestHookDecorators::test_on_step_compensate_is_passthrough PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnSuccess::test_publish_on_success_with_dict_result PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnSuccess::test_publish_on_success_with_non_dict_result PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnSuccess::test_publish_on_success_with_custom_payload_builder PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnSuccess::test_publish_on_success_handles_storage_error PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnSuccess::test_publish_on_success_uses_saga_id_as_aggregate_fallback PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnFailure::test_publish_on_failure_with_error PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnFailure::test_publish_on_failure_without_error_details PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnFailure::test_publish_on_failure_handles_storage_error PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnCompensate::test_publish_on_compensate PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestPublishOnCompensate::test_publish_on_compensate_handles_storage_error PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestLogStepLifecycle::test_log_step_lifecycle_returns_hooks PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestLogStepLifecycle::test_log_step_lifecycle_on_enter PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestLogStepLifecycle::test_log_step_lifecycle_on_success PASSED [ 25%]
tests/unit/core/test_hooks_listeners.py::TestLogStepLifecycle::test_log_step_lifecycle_on_failure PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestSagaListenerBase::test_base_listener_methods_are_noops PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_saga_start_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_step_enter_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_step_success_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_step_failure_logs_error PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_compensation_start_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_compensation_complete_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_saga_complete_logs PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_on_saga_failed_logs_error PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestLoggingSagaListener::test_custom_log_level PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestMetricsSagaListener::test_on_saga_start_records_time PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestMetricsSagaListener::test_on_saga_complete_records_duration PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestMetricsSagaListener::test_on_saga_failed_records_duration PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestMetricsSagaListener::test_creates_default_metrics_if_not_provided PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestTracingSagaListener::test_on_saga_start_starts_trace PASSED [ 26%]
tests/unit/core/test_hooks_listeners.py::TestTracingSagaListener::test_on_step_enter_starts_step_trace PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestTracingSagaListener::test_on_compensation_start_starts_compensation_trace PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_step_success_publishes_event PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_step_success_skipped_when_disabled PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_step_failure_publishes_event PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_saga_complete_publishes_event PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_saga_failed_publishes_event PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_on_compensation_complete_publishes_event PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestOutboxSagaListener::test_publish_event_handles_storage_error PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestDefaultListeners::test_default_listeners_with_all_options PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestDefaultListeners::test_default_listeners_with_no_options PASSED [ 27%]
tests/unit/core/test_hooks_listeners.py::TestDefaultListeners::test_default_listeners_defaults PASSED [ 27%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_saga_start_event PASSED [ 27%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_step_enter_event PASSED [ 27%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_step_success_event PASSED [ 27%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_step_failure_event PASSED [ 27%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_saga_complete_event PASSED [ 28%]
tests/unit/core/test_listeners.py::TestSagaListenerBasic::test_listener_receives_saga_failed_event PASSED [ 28%]
tests/unit/core/test_listeners.py::TestSagaListenerCompensation::test_listener_receives_compensation_events PASSED [ 28%]
tests/unit/core/test_listeners.py::TestMultipleListeners::test_multiple_listeners_all_receive_events PASSED [ 28%]
tests/unit/core/test_listeners.py::TestBuiltInListeners::test_metrics_listener_records_execution PASSED [ 28%]
tests/unit/core/test_listeners.py::TestBuiltInListeners::test_outbox_listener_publishes_events PASSED [ 28%]
tests/unit/core/test_listeners.py::TestListenerErrorHandling::test_listener_error_does_not_break_saga PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayConfig::test_default_config PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayConfig::test_custom_config PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayConfig::test_get_retention_until PASSED [ 28%]
tests/unit/core/test_replay.py::TestSagaSnapshot::test_create_snapshot PASSED [ 28%]
tests/unit/core/test_replay.py::TestSagaSnapshot::test_snapshot_defensive_copy PASSED [ 28%]
tests/unit/core/test_replay.py::TestSagaSnapshot::test_snapshot_to_dict PASSED [ 28%]
tests/unit/core/test_replay.py::TestSagaSnapshot::test_snapshot_from_dict PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayRequest::test_merge_context_no_override PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayRequest::test_merge_context_with_override PASSED [ 28%]
tests/unit/core/test_replay.py::TestReplayResult::test_mark_success PASSED [ 29%]
tests/unit/core/test_replay.py::TestReplayResult::test_mark_failed PASSED [ 29%]
tests/unit/core/test_replay.py::TestReplayResult::test_to_dict PASSED    [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_save_and_get_snapshot PASSED [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_get_nonexistent_snapshot PASSED [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_get_latest_snapshot PASSED [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_list_snapshots PASSED [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_delete_snapshot PASSED [ 29%]
tests/unit/core/test_replay.py::TestInMemorySnapshotStorage::test_delete_expired_snapshots PASSED [ 29%]
tests/unit/core/test_replay.py::TestSagaReplay::test_replay_from_checkpoint_not_found PASSED [ 29%]
tests/unit/core/test_replay.py::TestSagaReplay::test_replay_from_checkpoint_success PASSED [ 29%]
tests/unit/core/test_replay.py::TestSagaReplay::test_replay_dry_run PASSED [ 29%]
tests/unit/core/test_replay.py::TestSagaReplay::test_list_available_checkpoints PASSED [ 29%]
tests/unit/core/test_replay.py::TestSagaReplay::test_get_replay_history PASSED [ 29%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_metrics_initialization PASSED [ 29%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_record_successful_execution PASSED [ 29%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_record_failed_execution PASSED [ 30%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_record_rolled_back_execution PASSED [ 30%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_average_execution_time_calculation PASSED [ 30%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_per_saga_name_tracking PASSED [ 30%]
tests/unit/core/test_sagas.py::TestSagaMetrics::test_get_metrics_includes_success_rate PASSED [ 30%]
tests/unit/core/test_sagas.py::TestFailFastStrategy::test_fail_fast_cancels_immediately PASSED [ 30%]
tests/unit/core/test_sagas.py::TestWaitAllStrategy::test_wait_all_completes_everything PASSED [ 30%]
tests/unit/core/test_sagas.py::TestFailFastWithGraceStrategy::test_fail_fast_grace_waits_for_inflight PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStateMachine::test_state_machine_through_saga_execution PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStateMachine::test_state_machine_compensation_flow PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_initial_state PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_start_transition PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_succeed_transition PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_fail_transition PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_compensate_transition PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_compensation_success_transition PASSED [ 30%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_compensation_failure_transition PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestSagaStepStateMachine::test_invalid_transition PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_validate_state_transition_valid PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_validate_state_transition_invalid PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_validate_state_transition_final_states PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_validate_state_transition_unknown_state PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_get_valid_next_states PASSED [ 31%]
tests/unit/core/test_state_machine.py::TestStateValidation::test_get_valid_next_states_unknown PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestHistoricalState::test_to_dict PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_state_at_exact_snapshot_time PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_state_at_between_snapshots PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_state_at_before_first_snapshot PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_state_at_after_last_snapshot PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_state_at_naive_timestamp_converted_to_utc PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_list_state_changes_all PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_list_state_changes_with_after_filter PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_list_state_changes_with_before_filter PASSED [ 31%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_list_state_changes_with_limit PASSED [ 32%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_context_at_specific_key PASSED [ 32%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_context_at_all_keys PASSED [ 32%]
tests/unit/core/test_time_travel.py::TestSagaTimeTravel::test_get_context_at_nonexistent_time PASSED [ 32%]
tests/unit/core/test_time_travel.py::TestTimeTravelIntegration::test_time_travel_with_real_saga_snapshots PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_set_and_get PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_get_all PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_clear PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_scope_context_manager PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_nested_scopes PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestSagaContextManager::test_scope_isolation PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestCorrelationId::test_generate_correlation_id_format PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestCorrelationId::test_generate_correlation_id_uniqueness PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestCorrelationId::test_get_correlation_id_generates_if_missing PASSED [ 32%]
tests/unit/integrations/test_integrations_base.py::TestCorrelationId::test_get_correlation_id_returns_existing PASSED [ 32%]
tests/unit/integrations/test_integrations_fastapi.py::TestSagaLifecycle::test_startup_shutdown_no_errors PASSED [ 32%]
tests/unit/integrations/test_integrations_fastapi.py::TestCorrelationId::test_generate_correlation_id PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestCorrelationId::test_get_correlation_id_returns_generated PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestCreateWebhookRouter::test_creates_router PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestCreateWebhookRouter::test_creates_router_with_custom_prefix PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestCreateWebhookRouter::test_webhook_endpoint_exists PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestWebhookIntegration::test_webhook_returns_202_accepted PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestWebhookIntegration::test_webhook_handles_empty_body PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestSagaContextManager::test_context_manager_exists PASSED [ 33%]
tests/unit/integrations/test_integrations_fastapi.py::TestGetLogger::test_get_logger_returns_logger PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_init_with_app PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_init_app_later PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_before_request_sets_correlation_id PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_propagates_incoming_correlation_id PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_register_webhook_blueprint PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaFlask::test_webhook_returns_202 PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaContextManager::test_context_manager_exists PASSED [ 33%]
tests/unit/integrations/test_integrations_flask.py::TestSagaContextManager::test_context_manager_set_get PASSED [ 34%]
tests/unit/monitoring/test_logger.py::test_logger_propagation PASSED     [ 34%]
tests/unit/monitoring/test_logger.py::test_null_logger PASSED            [ 34%]
tests/unit/monitoring/test_logger.py::test_config_logging_usage PASSED   [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaJsonFormatter::test_json_formatter_basic PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaJsonFormatter::test_json_formatter_with_saga_context PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaJsonFormatter::test_json_formatter_with_record_attributes PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaContextFilter::test_context_filter_adds_saga_fields PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaContextFilter::test_context_filter_with_empty_context PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_initialization PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_context_injection PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_saga_lifecycle PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_step_lifecycle PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_log_level_filtering PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_step_failed PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_saga_logger_compensation_lifecycle PASSED [ 34%]
tests/unit/monitoring/test_monitoring.py::TestSagaLogger::test_setup_saga_logging PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_initialization PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_start_saga_trace PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_start_step_trace PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_trace_saga_action_decorator PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_trace_saga_compensation_decorator PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_record_saga_completion PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_record_step_completion PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_get_trace_context PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_create_child_span PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_setup_tracing PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_with_parent_context PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaTracer::test_tracer_error_recording PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaMetrics::test_metrics_initialization PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaMetrics::test_metrics_recording PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestSagaMetrics::test_metrics_calculations PASSED [ 35%]
tests/unit/monitoring/test_monitoring.py::TestMonitoringIntegration::test_saga_with_monitoring PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_prometheus_is_available PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_metrics_initialization PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_execution_completed PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_execution_failed PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_execution_rolled_back PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_step_duration PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_saga_started PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_saga_finished PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_saga_lifecycle_tracking PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_execution_with_string_status PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestStartMetricsServer::test_start_metrics_server_creates_server PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestStartMetricsServer::test_start_metrics_server_default_args PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestMetricsDisabled::test_methods_are_noop_when_disabled PASSED [ 36%]
tests/unit/monitoring/test_prometheus_metrics.py::TestMetricsDisabled::test_start_server_logs_error_when_unavailable PASSED [ 36%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_tracer_without_otel PASSED [ 36%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_start_saga_trace_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_start_step_trace_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_record_saga_completion_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_record_step_completion_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_get_trace_context_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithoutOTel::test_create_child_span_without_otel PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_tracer_initialization PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_start_saga_trace PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_start_saga_trace_with_parent_context PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_start_step_trace PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_saga_completion_success PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_saga_completion_failure PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_saga_completion_compensating PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_step_completion_success PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_step_completion_failure PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_record_step_completion_compensated PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_get_trace_context PASSED [ 37%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_create_child_span PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_start_saga_trace_with_exception PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestSagaTracerWithMockedOTel::test_start_step_trace_with_exception PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_action_without_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_compensation_without_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_action_with_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_compensation_with_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_action_with_context PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_compensation_with_context PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_action_exception_handling PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingDecorators::test_trace_saga_compensation_exception_handling PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingSetup::test_setup_tracing_without_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingSetup::test_setup_tracing_with_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing.py::TestTracingSetup::test_setup_tracing_with_endpoint PASSED [ 38%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_saga_tracer_init_with_otel PASSED [ 38%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_start_saga_trace_with_parent_context PASSED [ 38%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_start_saga_trace_exception_handling PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_start_step_trace_exception_handling PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_record_saga_completion_success PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_record_saga_completion_failure_with_error PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_record_step_completion_success PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_record_step_completion_failure_with_error PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_get_trace_context PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_create_child_span_with_attributes PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingWithMockedOTel::test_create_child_span_without_attributes PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingDecoratorsWithContext::test_trace_saga_action_with_saga_context PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingDecoratorsWithContext::test_trace_saga_compensation_with_saga_context PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestSetupTracingCoverage::test_setup_tracing_with_endpoint PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestSetupTracingCoverage::test_setup_tracing_no_endpoint PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingRecordCompletionEdgeCases::test_record_saga_completion_non_completed_status PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingRecordCompletionEdgeCases::test_record_saga_completion_rolled_back_status PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingRecordCompletionEdgeCases::test_record_step_completion_non_completed_status PASSED [ 39%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingRecordCompletionEdgeCases::test_record_step_completion_compensated_status PASSED [ 40%]
tests/unit/monitoring/test_tracing_mocked.py::TestTracingRecordCompletionEdgeCases::test_record_outside_span_context PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerConfig::test_kafka_is_available PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerConfig::test_default_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerConfig::test_custom_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerConfig::test_sasl_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerInitialization::test_broker_init_default_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerInitialization::test_broker_init_custom_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerInitialization::test_from_env PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerHelpers::test_convert_headers_none PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerHelpers::test_convert_headers_empty PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerHelpers::test_convert_headers_with_values PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerHelpers::test_encode_key_none PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerHelpers::test_encode_key_with_value PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerConfig::test_rabbitmq_is_available PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerConfig::test_default_config PASSED [ 40%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerConfig::test_custom_config PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerInitialization::test_broker_init_default_config PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerInitialization::test_broker_init_custom_config PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerInitialization::test_from_env PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerNotConnected::test_publish_without_connection PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestKafkaBrokerNotConnected::test_health_check_not_connected PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerNotConnected::test_publish_without_connection PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestRabbitMQBrokerNotConnected::test_health_check_not_connected PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestInMemoryBroker::test_publish_and_get_messages PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestInMemoryBroker::test_clear_messages PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestInMemoryBroker::test_health_check PASSED [ 41%]
tests/unit/outbox/test_brokers_coverage.py::TestInMemoryBroker::test_close PASSED [ 41%]
tests/unit/outbox/test_outbox.py::TestOutboxEvent::test_create_basic_event PASSED [ 41%]
tests/unit/outbox/test_outbox.py::TestOutboxEvent::test_create_event_with_all_fields PASSED [ 41%]
tests/unit/outbox/test_outbox.py::TestOutboxEvent::test_to_dict PASSED   [ 41%]
tests/unit/outbox/test_outbox.py::TestOutboxEvent::test_from_dict PASSED [ 41%]
tests/unit/outbox/test_outbox.py::TestOutboxStatus::test_all_statuses_exist PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_claim_event PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_claim_non_pending_fails PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_mark_sent PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_mark_failed PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_retry PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_retry_exceeds_max PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_move_to_dead_letter PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_can_retry PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_should_dead_letter PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestOutboxStateMachine::test_transition_callback PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryBroker::test_connect_and_publish PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryBroker::test_publish_with_headers PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryBroker::test_publish_without_connect_fails PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryBroker::test_health_check PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryBroker::test_publish_event PASSED [ 42%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_insert_and_get PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_claim_batch PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_update_status PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_get_events_by_saga PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_get_pending_count PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestInMemoryOutboxStorage::test_stuck_events PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_process_batch_success PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_process_batch_with_failure PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_dead_letter_on_max_retries PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_callbacks PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_get_stats PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxWorker::test_recover_stuck_events PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxConfig::test_default_values PASSED [ 43%]
tests/unit/outbox/test_outbox.py::TestOutboxConfig::test_from_env PASSED [ 43%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_get_available_brokers_includes_memory PASSED [ 43%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_memory_broker PASSED [ 43%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_broker_unknown_type PASSED [ 43%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_broker_case_insensitive PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_print_available_brokers PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_kafka_raises_when_unavailable PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_rabbitmq_raises_when_unavailable PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_broker_from_env_memory PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestBrokerFactory::test_create_broker_from_env_default PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestInMemoryBrokerAdvanced::test_clear_messages PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestInMemoryBrokerAdvanced::test_multiple_messages_same_topic PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestInMemoryBrokerAdvanced::test_close_resets_connected PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestKafkaBrokerConfig::test_default_values PASSED [ 44%]
tests/unit/outbox/test_outbox_brokers.py::TestRabbitMQBrokerConfig::test_default_values PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestWorkerMain::test_main_starts_and_stops_worker PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestWorkerMain::test_main_handles_startup_error PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestPostgreSQLStorageEdgeCases::test_load_saga_with_invalid_json_result PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestPostgreSQLStorageEdgeCases::test_load_saga_with_no_executed_at PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestPostgreSQLStorageEdgeCases::test_cleanup_completed_sagas_parses_count PASSED [ 44%]
tests/unit/outbox/test_outbox_edge_cases.py::TestPostgreSQLStorageEdgeCases::test_get_statistics_with_valid_size PASSED [ 45%]
tests/unit/outbox/test_outbox_edge_cases.py::TestRedisSagaStorageEdgeCases::test_list_sagas_with_both_status_and_name_filters PASSED [ 45%]
tests/unit/outbox/test_outbox_edge_cases.py::TestRedisSagaStorageEdgeCases::test_list_sagas_no_filters_gets_all PASSED [ 45%]
tests/unit/outbox/test_outbox_edge_cases.py::TestRedisSagaStorageEdgeCases::test_update_step_with_executed_at_timestamp PASSED [ 45%]
tests/unit/outbox/test_outbox_edge_cases.py::TestRedisSagaStorageEdgeCases::test_health_check_with_ping_and_info PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_get_available_brokers_returns_list PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_print_available_brokers_output PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_memory PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_memory_uppercase PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_memory_whitespace PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_unknown_type PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_kafka_available PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_kafka_with_config PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_rabbitmq_available PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_rabbitmq_aliases PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_from_env_memory PASSED [ 45%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_from_env_default PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestBrokerFactory::test_create_broker_from_env_unknown PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_with_saga_with_steps PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_with_saga_no_steps PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_has_completed_steps_true PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_has_completed_steps_false PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_callbacks_with_saga PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_state_machine_callback_saga_without_method PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_validate_state_transition_valid PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_validate_state_transition_invalid PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_get_valid_next_states PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStateMachine::test_get_valid_next_states_unknown PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStepStateMachine::test_step_state_machine_initialization PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStepStateMachine::test_step_state_machine_full_success_path PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStepStateMachine::test_step_state_machine_failure_path PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStepStateMachine::test_step_state_machine_compensation_path PASSED [ 46%]
tests/unit/outbox/test_outbox_extended.py::TestSagaStepStateMachine::test_step_state_machine_compensation_failure PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_config_defaults PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_config_custom_values PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_config_from_env PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_event_to_dict PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_event_from_dict PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxTypes::test_outbox_event_aggregate_id_defaults_to_saga_id PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_get_nonexistent_event PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_update_nonexistent_raises PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_claim_empty PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_insert_and_claim PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_get_pending_count PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxMemoryStorage::test_memory_storage_clear PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestKafkaBrokerMocked::test_kafka_broker_config_defaults PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestKafkaBrokerMocked::test_kafka_broker_from_env PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestRabbitMQBrokerMocked::test_rabbitmq_broker_config_defaults PASSED [ 47%]
tests/unit/outbox/test_outbox_extended.py::TestRabbitMQBrokerMocked::test_rabbitmq_broker_from_env PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestCompensationGraph::test_compensation_graph_empty PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestCompensationGraph::test_compensation_graph_single_step PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestCompensationGraph::test_compensation_graph_multiple_independent PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestCompensationGraph::test_compensation_graph_repr PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestDeclarativeSaga::test_saga_empty_run PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestDeclarativeSaga::test_saga_step_with_no_compensation PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxErrors::test_outbox_publish_error PASSED [ 48%]
tests/unit/outbox/test_outbox_extended.py::TestOutboxErrors::test_outbox_claim_error PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestOutboxWorkerCoverage::test_worker_start_stop_lifecycle PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestOutboxWorkerCoverage::test_worker_max_retries_exceeded PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestOutboxWorkerCoverage::test_worker_successful_publish PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestOutboxWorkerCoverage::test_worker_config_defaults PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestKafkaBrokerCoverage::test_kafka_from_env_with_defaults PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestKafkaBrokerCoverage::test_kafka_health_check_not_connected PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestKafkaBrokerCoverage::test_kafka_close_when_not_connected PASSED [ 48%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestKafkaBrokerCoverage::test_kafka_publish_not_connected PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestRabbitMQBrokerCoverage::test_rabbitmq_from_env PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestRabbitMQBrokerCoverage::test_rabbitmq_health_check_not_connected PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestRabbitMQBrokerCoverage::test_rabbitmq_close_when_not_connected PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestRabbitMQBrokerCoverage::test_rabbitmq_publish_not_connected PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestRabbitMQBrokerCoverage::test_rabbitmq_declare_queue_not_connected PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_get_events_by_saga PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_get_pending_count PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_claim_and_lock PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_get_stuck_events PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_release_stuck_events PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestPostgreSQLStorageCoverage::test_postgresql_get_by_id_not_found PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestCompensationGraphEdgeCases::test_compensation_graph_multiple_dependencies PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestStateElMachineEdgeCases::test_step_state_machine_failure_path PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestStateElMachineEdgeCases::test_step_state_machine_compensation_failure PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestStorageFactoryEdgeCases::test_storage_factory_postgresql_no_connection_string PASSED [ 49%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestStorageFactoryEdgeCases::test_storage_factory_redis_defaults PASSED [ 50%]
tests/unit/outbox/test_outbox_extended_coverage.py::TestBrokerFactoryEdgeCases::test_print_available_brokers PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_optimistic_send_success PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_optimistic_send_disabled PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_optimistic_send_timeout PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_optimistic_send_broker_error PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_topic_resolution_default PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestOptimisticPublisher::test_topic_resolution_custom_routing_key PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestConsumerInbox::test_process_idempotent_new_event PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestConsumerInbox::test_process_idempotent_duplicate_event PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestConsumerInbox::test_process_idempotent_handler_error PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestConsumerInbox::test_cleanup_old_entries PASSED [ 50%]
tests/unit/outbox/test_outbox_patterns.py::TestIntegrationOptimisticAndInbox::test_end_to_end_flow PASSED [ 50%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerBasic::test_worker_initialization PASSED [ 50%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerBasic::test_worker_auto_generates_id PASSED [ 50%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerBasic::test_get_stats PASSED [ 50%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerProcessBatch::test_process_batch_with_events PASSED [ 50%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerProcessBatch::test_process_batch_with_callback PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerFailureHandling::test_handle_publish_failure_increments_retry PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerFailureHandling::test_handle_publish_failure_moves_to_dead_letter PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerRecovery::test_recover_stuck_events PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerRecovery::test_recover_stuck_events_no_stuck PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerStop::test_stop_sets_flags PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerStop::test_handle_shutdown_creates_stop_task PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetStorageFactory::test_get_storage_without_env_exits PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetStorageFactory::test_get_storage_with_env PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetBrokerFactory::test_get_broker_kafka_without_url_exits PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetBrokerFactory::test_get_broker_unknown_type_exits PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetBrokerFactory::test_get_broker_kafka PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestGetBrokerFactory::test_get_broker_rabbitmq PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerStart::test_start_and_stop PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerStart::test_start_processes_events PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerProcessEvent::test_worker_max_retries_exceeded PASSED [ 51%]
tests/unit/outbox/test_outbox_worker.py::TestOutboxWorkerProcessEvent::test_worker_successful_publish PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConfig::test_default_values PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConfig::test_custom_values PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConfig::test_from_env PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConnection::test_connect_success PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConnection::test_connect_failure PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConnection::test_close PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConnection::test_health_check_healthy PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerConnection::test_health_check_unhealthy PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerPublish::test_publish_to_stream PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerPublish::test_publish_with_max_length PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerPublish::test_publish_not_connected_raises PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerPublish::test_publish_failure_raises PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerEvent::test_publish_outbox_event PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerFactory::test_create_redis_broker PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerFactory::test_redis_in_available_brokers PASSED [ 52%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerFactory::test_create_redis_raises_when_unavailable PASSED [ 53%]
tests/unit/outbox/test_redis_broker.py::TestRedisBrokerFromEnv::test_from_env PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerConfig::test_default_config PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerConfig::test_from_env PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_connect PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_connect_failure PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_publish PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_publish_not_connected PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_publish_failure PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_close PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_close_with_error PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_health_check_healthy PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_health_check_not_connected PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_health_check_ping_fails PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_ensure_consumer_group_new PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_ensure_consumer_group_exists PASSED [ 53%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_ensure_consumer_group_not_connected PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_read_messages PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_read_messages_not_connected PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_acknowledge PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_acknowledge_not_connected PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_get_stream_info PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_get_stream_info_not_connected PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_safe_url_masks_password PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_safe_url_no_password PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_from_env PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestRedisBrokerMocked::test_is_redis_available PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_get_available_brokers_includes_memory PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_get_available_brokers_with_all_deps PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_memory PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_kafka PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_rabbitmq PASSED [ 54%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_redis PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_unknown_type PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_missing_dependency PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_case_insensitive PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_memory PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_kafka PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_rabbitmq PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_redis PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_unknown PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_create_broker_from_env_default PASSED [ 55%]
tests/unit/outbox/test_redis_broker_factory.py::TestBrokerFactory::test_print_available_brokers PASSED [ 55%]
tests/unit/storage/backends/test_redis_outbox_branches.py::test_redis_close_not_connected PASSED [ 55%]
tests/unit/storage/backends/test_redis_outbox_branches.py::test_redis_serialize_minimal_event PASSED [ 55%]
tests/unit/storage/backends/test_redis_outbox_branches.py::test_update_status_branches PASSED [ 55%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLStorageImportError::test_asyncpg_not_available_import_error PASSED [ 55%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageUnit::test_postgresql_initialization PASSED [ 55%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageUnit::test_postgresql_connection_error_handling PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLStorageEdgeCases::test_postgresql_step_result_parsing PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLStorageEdgeCases::test_postgresql_step_with_timestamps PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_save_saga_state PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_load_saga_state PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_update_step_state PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_cleanup_completed_sagas PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_health_check_healthy PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_format_bytes PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_format_bytes_large_values PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_delete_saga_state PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_delete_saga_state_not_found PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_list_sagas_no_filters PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_list_sagas_with_status_filter PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_list_sagas_with_name_filter PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_list_sagas_with_both_filters PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_count_sagas PASSED [ 56%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_context_manager_enter_exit PASSED [ 57%]
tests/unit/storage/backends/test_storage_postgresql.py::TestPostgreSQLSagaStorageMocked::test_context_manager_exit_no_pool PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageImportError::test_redis_not_available_import_error PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageUnit::test_redis_initialization PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageUnit::test_redis_key_generation PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageUnit::test_redis_connection_error_handling PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageEdgeCases::test_redis_json_decode_error PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_save_saga_state PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_load_saga_state PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_load_saga_state_not_found PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_load_saga_state_invalid_json PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_delete_saga_state PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_delete_saga_state_not_found PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_list_sagas_by_status PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_update_step_state PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_update_step_state_saga_not_found PASSED [ 57%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_update_step_state_step_not_found PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_get_saga_statistics PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_cleanup_completed_sagas PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_health_check_healthy PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_health_check_unhealthy PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_context_manager PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisSagaStorageMocked::test_key_generation PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_save_and_load_saga_state PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_load_nonexistent_saga PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_delete_saga_state PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_list_sagas_by_status PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_ttl_applied_to_completed_sagas PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_update_existing_saga PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_update_step_state PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_get_saga_statistics PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_cleanup_completed_sagas PASSED [ 58%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_health_check PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_connection_error_handling PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_list_sagas_with_limit PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_update_step_state_on_nonexistent_saga PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_update_step_state_on_nonexistent_step PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_cleanup_with_invalid_timestamps PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_list_sagas_with_status_and_name_filter PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_list_sagas_no_filter_pagination PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis.py::TestRedisStorageIntegration::test_delete_nonexistent_saga PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_initialization PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_initialization_group_exists PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_insert_event PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_get_by_id_found PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_get_by_id_not_found PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_update_status_sent PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_update_status_failed_with_error PASSED [ 59%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_claim_batch_empty PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_claim_batch_with_events PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_get_pending_count PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_health_check_healthy PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_health_check_unhealthy PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_get_statistics PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_get_dead_letter_events PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_context_manager PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_count PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_export_all PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_export_all_empty PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_import_record PASSED [ 60%]
tests/unit/storage/backends/test_storage_redis_outbox.py::TestRedisOutboxStorageUnit::test_import_record_without_optional_fields PASSED [ 60%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_save_and_load_saga PASSED [ 60%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_load_nonexistent_saga PASSED [ 60%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_update_saga_state PASSED [ 60%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_delete_saga PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_delete_nonexistent_saga PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_list_sagas PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_list_sagas_with_name_filter PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_update_step_state PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_get_saga_statistics PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_cleanup_completed_sagas PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_health_check PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_count PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_export_all PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteSagaStorage::test_import_record PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_insert_and_get_event PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_get_nonexistent_event PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_update_status PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_claim_batch PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_get_events_by_saga PASSED [ 61%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_get_pending_count PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_get_dead_letter_events PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_health_check PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_get_statistics PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_count PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_export_all PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteOutboxStorage::test_import_record PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteStorageFactory::test_create_sqlite_saga_storage PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteStorageFactory::test_create_sqlite_outbox_storage PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteStorageFactory::test_create_sqlite_both_storages PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteStorageFactory::test_create_sqlite_with_db_path PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteStorageFactory::test_sqlite_in_available_backends PASSED [ 62%]
tests/unit/storage/backends/test_storage_sqlite.py::TestSQLiteTransfer::test_transfer_from_memory_to_sqlite PASSED [ 62%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_save_and_get PASSED [ 62%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_get_nonexistent PASSED [ 62%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_get_latest PASSED [ 62%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_get_latest_no_snapshots PASSED [ 62%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_list_snapshots PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_list_empty PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_delete_snapshot PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_delete_nonexistent PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_delete_expired PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_pagination PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestInMemorySnapshotStorage::test_large_context PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestRedisSnapshotStorageMocked::test_missing_dependency_redis PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestRedisSnapshotStorageMocked::test_missing_dependency_zstd PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestPostgreSQLSnapshotStorageMocked::test_missing_dependency PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestS3SnapshotStorageMocked::test_missing_dependency_aioboto3 PASSED [ 63%]
tests/unit/storage/test_snapshot_backends.py::TestS3SnapshotStorageMocked::test_missing_dependency_zstd PASSED [ 63%]
tests/unit/storage/test_storage.py::TestSagaStepState::test_step_state_creation PASSED [ 63%]
tests/unit/storage/test_storage.py::TestSagaStepState::test_step_state_to_dict PASSED [ 63%]
tests/unit/storage/test_storage.py::TestSagaStepState::test_step_state_from_dict PASSED [ 63%]
tests/unit/storage/test_storage.py::TestSagaStepState::test_step_state_roundtrip PASSED [ 63%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_save_and_load_saga_state PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_load_nonexistent_saga PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_delete_saga_state PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_list_sagas PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_update_step_state PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_cleanup_completed_sagas PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_health_check PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_context_manager PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_update_step_state_saga_not_found PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_update_step_state_step_not_found PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_get_saga_statistics PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_cleanup_sagas_invalid_timestamp PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_clear_all PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemorySagaStorage::test_get_saga_count PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemoryStorageListFiltering::test_list_sagas_with_status_mismatch PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemoryStorageListFiltering::test_list_sagas_with_name_mismatch PASSED [ 64%]
tests/unit/storage/test_storage.py::TestInMemoryStorageListFiltering::test_cleanup_with_custom_statuses PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_initialization PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_already_initialized PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_consumer_group_already_exists PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_close PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_insert PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_by_id PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_by_id_not_found PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_update_status_sent PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_update_status_failed_with_error PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_claim_batch_no_messages PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_claim_batch_error PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_events_by_saga PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_pending_count PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_pending_count_error PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_health_check_healthy PASSED [ 65%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_health_check_unhealthy PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_health_check_not_initialized PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_statistics PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_context_manager PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_stuck_events PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_stuck_events_error PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_release_stuck_events PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_release_stuck_events_error PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_dead_letter_events PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestRedisOutboxStorageCoverage::test_redis_outbox_get_dead_letter_events_error PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_update_step_not_found PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_update_step_success PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_update_step_with_error PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_update_step_with_executed_at PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_cleanup_completed PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_health_check_unhealthy PASSED [ 66%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_export_all PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_import_record PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteSagaStorageCoverage::test_sqlite_saga_list_with_filters PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_get_events_by_saga PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_health_check_healthy PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_health_check_unhealthy PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_export_all PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_import_record PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_get_dead_letter_events PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_get_statistics PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStorageCoverage::test_sqlite_outbox_count PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestPostgreSQLOutboxStorageCoverage::test_postgresql_outbox_count_not_initialized PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestPostgreSQLOutboxStorageCoverage::test_postgresql_outbox_export_all_not_initialized PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestPostgreSQLOutboxStorageCoverage::test_postgresql_outbox_count_success PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestPostgreSQLOutboxStorageCoverage::test_postgresql_outbox_import_record PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestInMemoryOutboxStorageCoverage::test_inmemory_outbox_export_all PASSED [ 67%]
tests/unit/storage/test_storage_backends_coverage.py::TestInMemoryOutboxStorageCoverage::test_inmemory_outbox_import_record PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestInMemoryOutboxStorageCoverage::test_inmemory_outbox_count PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestInMemoryOutboxStorageCoverage::test_inmemory_outbox_get_dead_letter_events PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStuckEvents::test_sqlite_outbox_claim_batch_empty PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStuckEvents::test_sqlite_outbox_get_stuck_events_none PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestSQLiteOutboxStuckEvents::test_sqlite_outbox_release_stuck_events_none PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestLazyGetAttrCompatModules::test_outbox_init_lazy_getattr PASSED [ 68%]
tests/unit/storage/test_storage_backends_coverage.py::TestLazyGetAttrCompatModules::test_outbox_storage_canonical_imports PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_storage_error_base PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_storage_error_with_details PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_connection_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_not_found_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_serialization_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_transfer_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_transaction_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_concurrency_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_capacity_error PASSED [ 68%]
tests/unit/storage/test_storage_core.py::TestStorageErrors::test_error_inheritance PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_simple_dict PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_datetime PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_uuid PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_decimal PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_bytes PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_set PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_nested PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_deserialize_invalid_json PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestSerialization::test_serialize_bytes_input PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_health_status_values PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_health_check_result PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_health_check_result_degraded_is_healthy PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_health_check_result_unhealthy PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_health_check_result_to_dict PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestHealthCheck::test_storage_statistics PASSED [ 69%]
tests/unit/storage/test_storage_core.py::TestConnectionConfig::test_connection_config_defaults PASSED [ 70%]
tests/unit/storage/test_storage_core.py::TestConnectionConfig::test_connection_config_custom PASSED [ 70%]
tests/unit/storage/test_storage_core.py::TestPoolStatus::test_pool_status_utilization PASSED [ 70%]
tests/unit/storage/test_storage_core.py::TestPoolStatus::test_pool_status_empty PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_base_storage_abstract PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_base_storage_context_manager PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_base_storage_health_check_closed PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_base_storage_health_check_with_connection_manager PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_base_storage_get_statistics_default PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestBaseStorageExtended::test_log_operation PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestTransferableStorageExtended::test_clear_not_implemented PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestConnectionConfigExtended::test_connection_config_options_default PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestConnectionConfigExtended::test_connection_config_with_none_options PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_enum PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_frozenset PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_object_with_dict PASSED [ 70%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_for_redis_none PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_for_redis_bool PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_for_redis_datetime PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_for_redis_uuid PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_serialize_for_redis_complex PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_bytes PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_with_schema PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_datetime_schema PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_uuid_schema PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_json_value PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_invalid_json PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSerializationExtended::test_deserialize_from_redis_empty_string PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestHealthCheckExtended::test_check_health_with_timeout_success PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestHealthCheckExtended::test_check_health_with_timeout_timeout PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestHealthCheckExtended::test_check_health_with_timeout_exception PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_lifecycle PASSED [ 71%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_reconnect PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_pool_status PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_health_check_no_connection PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_health_check_invalid PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_health_check_exception PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_single_connection_manager_context_manager PASSED [ 72%]
tests/unit/storage/test_storage_core_extended.py::TestSingleConnectionManagerExtended::test_connection_manager_acquire_context_manager PASSED [ 72%]
tests/unit/storage/test_storage_errors.py::TestPostgreSQLStorageErrors::test_import_error_when_asyncpg_not_available PASSED [ 72%]
tests/unit/storage/test_storage_errors.py::TestRedisStorageErrors::test_import_error_when_redis_not_available PASSED [ 72%]
tests/unit/storage/test_storage_errors.py::TestMemoryStorageEdgeCases::test_update_step_state_with_nonexistent_saga PASSED [ 72%]
tests/unit/storage/test_storage_errors.py::TestMemoryStorageEdgeCases::test_update_step_state_with_nonexistent_step PASSED [ 72%]
tests/unit/storage/test_storage_errors.py::TestStorageBaseClassEdgeCases::test_context_manager_without_implementation PASSED [ 72%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_memory_storage PASSED [ 72%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_memory_storage_uppercase PASSED [ 72%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_memory_storage_with_whitespace PASSED [ 72%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_redis_storage PASSED [ 72%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_postgresql_storage PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_postgresql_without_connection_string PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_postgres_alias PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_create_pg_alias PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_unknown_backend_raises_error PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorage::test_invalid_storage_type_raises_error PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_memory_saga_storage PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_memory_outbox_storage PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_memory_both_storages PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_redis_outbox_storage PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_redis_both_storages PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_postgresql_outbox_without_connection_string PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_create_postgresql_outbox_storage PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestCreateStorageTypes::test_default_storage_type_is_saga PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestGetAvailableBackends::test_returns_dict PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestGetAvailableBackends::test_memory_always_available PASSED [ 73%]
tests/unit/storage/test_storage_factory.py::TestGetAvailableBackends::test_contains_expected_keys PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestGetAvailableBackends::test_includes_redis_info PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestGetAvailableBackends::test_includes_postgresql_info PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestPrintAvailableBackends::test_prints_output PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestPrintAvailableBackends::test_shows_status_indicators PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestMissingDependencyError::test_error_message_contains_package PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestMissingDependencyError::test_error_message_contains_install_command PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestMissingDependencyError::test_error_message_contains_feature PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestMissingDependencyError::test_error_attributes PASSED [ 74%]
tests/unit/storage/test_storage_factory.py::TestMissingDependencyError::test_unknown_package_uses_default_install PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_saga_storage_is_abstract PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_concrete_saga_storage PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_export_all_not_implemented PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_import_record_not_implemented PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_count_default_uses_list_sagas PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_context_manager PASSED [ 74%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStorageInterface::test_close_default PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_creation PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_to_dict PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_to_dict_with_nulls PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_from_dict PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_from_dict_minimal PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestSagaStepState::test_from_dict_with_compensated_at PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_outbox_storage_is_abstract PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_concrete_outbox_storage PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_health_check_default PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_health_check_exception PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_get_statistics_default PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_export_all_not_implemented PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_import_record_not_implemented PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_count_default PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_archive_events_not_implemented PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_context_manager PASSED [ 75%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageInterface::test_close_default PASSED [ 76%]
tests/unit/storage/test_storage_interfaces.py::TestOutboxStorageError::test_outbox_storage_error PASSED [ 76%]
tests/unit/storage/test_storage_interfaces.py::TestTransferableProtocol::test_transferable_protocol_check PASSED [ 76%]
tests/unit/storage/test_storage_interfaces.py::TestTransferableProtocol::test_non_transferable_fails_check PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestBaseStorageManager::test_base_storage_manager_is_abstract PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_initialize_creates_storages PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_saga_property_before_init_raises PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_outbox_property_before_init_raises PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_context_manager PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_health_check PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_saga_operations PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestInMemoryStorageManager::test_outbox_operations PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_memory_from_url PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_memory_from_none PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_memory_from_backend PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_postgresql_from_url PASSED [ 76%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_postgresql_from_postgres_url PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_redis_from_url PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_sqlite_from_url PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_sqlite_from_file_path PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_sqlite_memory PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_from_explicit_backend PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_unknown_backend_raises PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_postgresql_without_url_raises PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestCreateStorageManager::test_create_unknown_url_raises PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestPostgreSQLStorageManager::test_saga_property_before_init_raises PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestPostgreSQLStorageManager::test_health_check_not_initialized PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestRedisStorageManager::test_saga_property_before_init_raises PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestRedisStorageManager::test_health_check_not_initialized PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestSQLiteStorageManager::test_sqlite_memory_operations PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestSQLiteStorageManager::test_health_check_healthy PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestStorageManagerExports::test_exports_from_storage_module PASSED [ 77%]
tests/unit/storage/test_storage_manager.py::TestHybridMode::test_create_hybrid_manager PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestHybridMode::test_is_hybrid_same_backend PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestHybridMode::test_is_hybrid_different_backend PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestHybridMode::test_hybrid_health_check_shows_different_backends PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestHybridMode::test_hybrid_sqlite_saga_and_outbox PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_config_with_storage_manager PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_config_cannot_mix_manager_with_storage PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_config_cannot_mix_manager_with_outbox_storage PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_config_manager_not_initialized_warning PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_config_manager_with_broker PASSED [ 78%]
tests/unit/storage/test_storage_manager.py::TestSagaConfigIntegration::test_saga_with_storage_manager PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_create_storage_manager_explicit_backend PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_storage_manager_hybrid_mode PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_initialize_unified_postgresql PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_initialize_unified_redis PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_health_check_exceptions PASSED [ 78%]
tests/unit/storage/test_storage_manager_coverage.py::test_create_storage_manager_unknown_url_scheme PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferConfig::test_default_values PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferConfig::test_custom_values PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferConfig::test_string_policy_conversion PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_default_values PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_is_complete_when_done PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_is_complete_when_not_done PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_success_rate PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_success_rate_zero_total PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_elapsed_seconds PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_records_per_second PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_records_per_second_zero_elapsed PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_estimated_remaining_seconds PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgress::test_to_dict PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferResult::test_default_values PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferResult::test_total_processed PASSED [ 79%]
tests/unit/storage/test_storage_transfer.py::TestTransferResult::test_success_true PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferResult::test_success_false PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferResult::test_to_dict PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_all_success PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_all_with_config PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_empty_source PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_failures_skip_policy PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_failures_abort_policy PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_failures_retry_policy PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_progress_callback PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_progress_property PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_cancel PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_source_without_export PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_target_without_import PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_validation PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_validation_failure PASSED [ 80%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_transfer_with_event_id PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_source_without_count PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferService::test_progress_callback_exception PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferDataFunction::test_transfer_data_basic PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferDataFunction::test_transfer_data_with_options PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferErrorPolicy::test_policy_values PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferErrorPolicy::test_policy_from_string PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgressEdgeCases::test_progress_with_high_transferred PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgressEdgeCases::test_progress_rate_with_transfers PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferProgressEdgeCases::test_estimated_remaining_with_rate PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferServiceEdgeCases::test_transfer_with_count_exception PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferServiceEdgeCases::test_transfer_records_no_id PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferServiceEdgeCases::test_transfer_with_event_id_validation PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferServiceEdgeCases::test_unknown_error_policy_falls_through PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferValidationEdgeCases::test_validation_with_id_field PASSED [ 81%]
tests/unit/storage/test_storage_transfer.py::TestTransferValidationEdgeCases::test_get_by_id_validation_failure PASSED [ 81%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_all_steps_succeed PASSED [ 81%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_one_step_fails_fast PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_multiple_steps_fail PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_empty_steps_list PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_single_step PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastStrategy::test_strategy_itself_cancelled PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestWaitAllStrategy::test_all_steps_succeed PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestWaitAllStrategy::test_some_steps_fail_wait_all PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestWaitAllStrategy::test_multiple_failures_collect_all PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestWaitAllStrategy::test_wait_for_slowest_step PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_all_steps_succeed PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_graceful_cancellation PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_grace_period_configuration PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_no_grace_period PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_should_wait_for_completion PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_get_description PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_strategy_cancellation_handling PASSED [ 82%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_empty_steps_list PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestFailFastWithGraceStrategy::test_timeout_during_grace_period PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyIntegration::test_strategy_with_successful_steps PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyIntegration::test_strategy_polymorphic_usage PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyIntegration::test_strategy_failure_behavior_differences PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyBase::test_strategy_interface PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyBase::test_strategy_polymorphism PASSED [ 83%]
tests/unit/strategies/test_strategies.py::TestStrategyBase::test_strategy_factory_pattern PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigBasics::test_default_config PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigBasics::test_custom_storage PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigBasics::test_custom_broker PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigBasics::test_custom_timeout_and_retries PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigListeners::test_default_listeners PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigListeners::test_disable_logging PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigListeners::test_disable_metrics PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigListeners::test_enable_tracing PASSED [ 83%]
tests/unit/test_config.py::TestSagaConfigListeners::test_custom_listener_instance PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigListeners::test_broker_adds_outbox_listener PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigOutboxStorageDerivation::test_no_broker_no_outbox_derivation PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigOutboxStorageDerivation::test_broker_with_explicit_outbox_storage PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigOutboxStorageDerivation::test_broker_with_memory_storage_warns PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigOutboxStorageDerivation::test_broker_with_postgresql_storage_derives PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigOutboxStorageDerivation::test_broker_with_redis_storage_warns PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigImmutableUpdates::test_with_storage PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigImmutableUpdates::test_with_broker PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigImmutableUpdates::test_with_broker_and_outbox PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_default PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_memory_storage PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_metrics_disabled PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_tracing_enabled PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_invalid_storage_url PASSED [ 84%]
tests/unit/test_config.py::TestSagaConfigFromEnv::test_from_env_invalid_broker_url PASSED [ 84%]
tests/unit/test_config.py::TestGlobalConfiguration::test_get_config_default PASSED [ 85%]
tests/unit/test_config.py::TestGlobalConfiguration::test_configure_sets_global PASSED [ 85%]
tests/unit/test_config.py::TestSagaIntegrationWithConfig::test_saga_uses_global_config_listeners PASSED [ 85%]
tests/unit/test_config.py::TestSagaIntegrationWithConfig::test_saga_class_listeners_override_config PASSED [ 85%]
tests/unit/test_config.py::TestSagaIntegrationWithConfig::test_saga_with_explicit_config PASSED [ 85%]
tests/unit/test_config.py::TestSagaConfigRepr::test_repr_shows_key_fields PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_empty_yaml PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_minimal_yaml PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_not_found PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_postgresql_storage PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_postgresql_storage_without_url PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_redis_storage PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_kafka_broker PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_redis_broker PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_rabbitmq_broker PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_amqp_broker PASSED [ 85%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_observability_settings PASSED [ 86%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_unknown_storage_type PASSED [ 86%]
tests/unit/test_config_coverage.py::TestSagaConfigFromFile::test_from_file_unknown_broker_type PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_postgresql_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_postgres_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_redis_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_memory_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_empty_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseStorageUrl::test_parse_unknown_storage_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_kafka_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_redis_broker_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_amqp_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_rabbitmq_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_memory_broker_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_empty_broker_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestParseBrokerUrl::test_parse_unknown_broker_url PASSED [ 86%]
tests/unit/test_config_coverage.py::TestGlobalConfig::test_get_config_returns_default PASSED [ 87%]
tests/unit/test_config_coverage.py::TestGlobalConfig::test_configure_sets_global PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_config_with_custom_listener_instances PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_config_derives_postgresql_outbox_without_conn_string PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_storage_url_postgresql PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_storage_url_postgres PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_storage_url_redis PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_storage_url_unknown PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_kafka PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_redis PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_rabbitmq PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_amqp PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_memory PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigCoverage::test_parse_broker_url_unknown PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigFromEnv::test_from_env_with_all_options PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigFromEnv::test_from_env_with_no_env_vars PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaConfigFromEnv::test_from_env_boolean_parsing PASSED [ 87%]
tests/unit/test_config_extended.py::TestSagaStateMachineCoverage::test_state_machine_without_saga PASSED [ 88%]
tests/unit/test_config_extended.py::TestSagaStateMachineCoverage::test_state_machine_callbacks_without_saga_methods PASSED [ 88%]
tests/unit/test_config_extended.py::TestSagaStateMachineCoverage::test_state_machine_on_exit_executing PASSED [ 88%]
tests/unit/test_config_extended.py::TestDecoratorsCoverage::test_to_mermaid_with_execution_compensating_status PASSED [ 88%]
tests/unit/test_config_extended.py::TestDecoratorsCoverage::test_saga_get_step_not_found PASSED [ 88%]
tests/unit/test_config_extended.py::TestCompensationGraphCoverage::test_compensation_graph_edge_cases PASSED [ 88%]
tests/unit/test_config_extended.py::TestMermaidAdditionalCoverage::test_mermaid_add_start_to_roots_skips_unexecuted PASSED [ 88%]
tests/unit/test_config_extended.py::TestMermaidAdditionalCoverage::test_mermaid_add_leaves_to_success_skips_unexecuted PASSED [ 88%]
tests/unit/test_config_extended.py::TestMermaidAdditionalCoverage::test_mermaid_failure_edges_no_compensable_steps PASSED [ 88%]
tests/unit/test_config_extended.py::TestMermaidAdditionalCoverage::test_mermaid_dag_compensation_chain_skip_non_compensated PASSED [ 88%]
tests/unit/test_config_extended.py::TestGlobalConfigFunctions::test_get_config_creates_default PASSED [ 88%]
tests/unit/test_config_extended.py::TestGlobalConfigFunctions::test_configure_sets_global_config PASSED [ 88%]
tests/unit/test_factories.py::TestFinalCoverage::test_outbox_types_from_dict PASSED [ 88%]
tests/unit/test_factories.py::TestFinalCoverage::test_state_machine_callbacks PASSED [ 88%]
tests/unit/test_factories.py::TestFinalCoverage::test_compensation_graph_reset PASSED [ 88%]
tests/unit/test_factories.py::TestFinalCoverage::test_broker_factory_get_available PASSED [ 88%]
tests/unit/test_factories.py::TestFinalCoverage::test_storage_factory_get_available PASSED [ 89%]
tests/unit/test_factories.py::TestFinalCoverage::test_compensation_graph_unexecuted_steps PASSED [ 89%]
tests/unit/test_factories.py::TestFinalCoverage::test_broker_factory_unknown_type PASSED [ 89%]
tests/unit/test_factories.py::TestFinalCoverage::test_state_machine_step_lifecycle PASSED [ 89%]
tests/unit/test_factories.py::TestFinalCoverage::test_worker_batch_processing PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_with_total_duration_comment PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_with_step_durations PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_with_compensation_durations PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_failed_trail_with_total_duration PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_success_trail_with_total_duration PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_skips_unexecuted_nodes_with_trail PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_sequential_no_deps PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_highlight_trail_from_dict_none PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_highlight_trail_from_dict_full PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_no_compensable_ancestors PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_root_compensation_steps_sequential PASSED [ 89%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_empty_steps_list PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_no_state_markers PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_show_compensation_false PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_dag_with_multiple_roots PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_direction_lr PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_compensation_chain_sequential PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_no_compensation_nodes_when_no_compensable_steps PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_trail_with_only_failed_step PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneratorEdgeCases::test_mermaid_root_compensation_steps_dag PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_to_mermaid_sequential PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_to_mermaid_with_deps PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_to_mermaid_markdown PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_to_mermaid_direction PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_root_steps_stadium_shape PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_shows_compensation PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_no_compensation_no_arrow PASSED [ 90%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_hide_compensation PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_parallel_dag_compensation PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_to_mermaid_with_execution PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_to_mermaid_sequential PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_to_mermaid_with_deps PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_state_markers PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_hide_state_markers PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_highlight_trail PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_to_mermaid_with_execution_no_state PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_to_mermaid_with_execution_with_state PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_classic_saga_to_mermaid_markdown PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_state_markers PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_hide_state_markers PASSED [ 91%]
tests/unit/test_mermaid.py::TestMermaidGeneration::test_declarative_saga_highlight_trail PASSED [ 91%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_connected_saga_passes_validation PASSED [ 91%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_disjoint_saga_raises_error PASSED [ 91%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_single_step_saga_always_valid PASSED [ 92%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_sequential_saga_always_valid PASSED [ 92%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_three_component_disjoint_saga_shows_groups PASSED [ 92%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_linear_chain_is_connected PASSED [ 92%]
tests/unit/test_mermaid.py::TestConnectedGraphValidation::test_diamond_pattern_is_connected PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_success_trail_rendering PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_failure_trail_rendering PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_partial_success_no_rollback PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_trail_from_dict PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_trail_from_none PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_rendering_independent_steps PASSED [ 92%]
tests/unit/test_mermaid_trails.py::TestMermaidTrails::test_only_executed_nodes_shown PASSED [ 92%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_orchestrator_initialization PASSED [ 92%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_single_saga_execution PASSED [ 92%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_multiple_concurrent_sagas PASSED [ 92%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_saga_failure_handling PASSED [ 92%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_mixed_success_and_failure PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_orchestrator_concurrent_execution PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_get_saga_status PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_orchestrator_metrics PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_get_all_sagas_status PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_count_by_status PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_count_rolled_back PASSED [ 93%]
tests/unit/test_orchestrator.py::TestSagaOrchestrator::test_get_saga_returns_none_for_unknown_id PASSED [ 93%]
tests/unit/test_patterns.py::TestConsumerInboxUnit::test_consumer_inbox_process_idempotent PASSED [ 93%]
tests/unit/test_patterns.py::TestConsumerInboxUnit::test_consumer_inbox_duplicate_detection PASSED [ 93%]
tests/unit/test_patterns.py::TestOptimisticPublisherUnit::test_optimistic_publisher_publish_after_commit_success PASSED [ 93%]
tests/unit/test_patterns.py::TestOptimisticPublisherUnit::test_optimistic_publisher_disabled PASSED [ 93%]
tests/unit/test_patterns.py::TestOptimisticPublisherUnit::test_optimistic_publisher_publish_failure PASSED [ 93%]
tests/unit/test_patterns.py::TestTracingSpanRecording::test_record_saga_completion_not_recording PASSED [ 93%]
tests/unit/test_patterns.py::TestTracingSpanRecording::test_record_step_completion_failure_with_error PASSED [ 93%]
tests/unit/test_patterns.py::TestCompensationGraphCycleEdgeCases::test_find_cycle_with_already_visited_node PASSED [ 93%]
tests/unit/test_patterns.py::TestCompensationGraphCycleEdgeCases::test_circular_dependency_raises_error PASSED [ 93%]
tests/unit/test_patterns.py::TestStatusBranchCoverage::test_to_mermaid_with_execution_compensating_status PASSED [ 94%]
tests/unit/test_patterns.py::TestDecoratorStatusBranches::test_saga_compensated_status_handling PASSED [ 94%]
tests/unit/test_patterns.py::TestSetupTracingImportError::test_setup_tracing_otlp_import_error PASSED [ 94%]
tests/unit/test_patterns.py::TestTracingUnavailableFallbacks::test_saga_tracer_no_tracing PASSED [ 94%]
tests/unit/test_pivot.py::TestRecoveryAction::test_all_values_exist PASSED [ 94%]
tests/unit/test_pivot.py::TestRecoveryAction::test_enum_count PASSED     [ 94%]
tests/unit/test_pivot.py::TestStepZone::test_all_values_exist PASSED     [ 94%]
tests/unit/test_pivot.py::TestStepZone::test_enum_count PASSED           [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_empty_zones PASSED         [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_zone_reversible PASSED [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_zone_pivot PASSED      [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_zone_committed PASSED  [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_zone_tainted PASSED    [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_zone_unknown_returns_reversible PASSED [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_is_rollback_allowed PASSED [ 94%]
tests/unit/test_pivot.py::TestSagaZones::test_get_effective_pivot PASSED [ 94%]
tests/unit/test_pivot.py::TestTaintPropagator::test_get_ancestors_simple PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_get_ancestors_diamond PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_get_descendants_simple PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_propagate_taint PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_calculate_zones PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_get_rollback_boundary PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_can_compensate PASSED [ 95%]
tests/unit/test_pivot.py::TestTaintPropagator::test_calculate_zones_with_reversible PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepPivot::test_pivot_default_false PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepPivot::test_pivot_can_be_set PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepPivot::test_can_compensate_not_tainted PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepPivot::test_can_compensate_tainted PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepPivot::test_can_compensate_no_compensation PASSED [ 95%]
tests/unit/test_pivot.py::TestStepMetadataPivot::test_pivot_default_false PASSED [ 95%]
tests/unit/test_pivot.py::TestStepMetadataPivot::test_pivot_can_be_set PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepDefinitionPivot::test_pivot_default_false PASSED [ 95%]
tests/unit/test_pivot.py::TestSagaStepDefinitionPivot::test_pivot_can_be_set PASSED [ 96%]
tests/unit/test_pivot.py::TestForwardRecoveryMetadata::test_required_fields PASSED [ 96%]
tests/unit/test_pivot.py::TestForwardRecoveryMetadata::test_default_values PASSED [ 96%]
tests/unit/test_pivot.py::TestForwardRecoveryMetadata::test_custom_values PASSED [ 96%]
tests/unit/test_pivot.py::TestSagaResultPivot::test_default_values PASSED [ 96%]
tests/unit/test_pivot.py::TestSagaResultPivot::test_pivot_fields_can_be_set PASSED [ 96%]
tests/unit/test_pivot.py::TestSagaResultPivot::test_is_partially_committed PASSED [ 96%]
tests/unit/test_pivot.py::TestSagaResultPivot::test_needs_intervention PASSED [ 96%]
tests/unit/test_pivot.py::TestNewSagaStatuses::test_partially_committed_exists PASSED [ 96%]
tests/unit/test_pivot.py::TestNewSagaStatuses::test_forward_recovery_exists PASSED [ 96%]
tests/unit/test_pivot.py::TestNewSagaStepStatuses::test_tainted_exists PASSED [ 96%]
tests/unit/test_pivot.py::TestNewSagaStepStatuses::test_skipped_exists PASSED [ 96%]
tests/unit/test_pivot.py::TestPivotSagaIntegration::test_pivot_step_taints_ancestors PASSED [ 96%]
tests/unit/test_pivot.py::TestPivotSagaIntegration::test_forward_recovery_handler_collection PASSED [ 96%]
tests/unit/test_pivot.py::TestPivotSagaIntegration::test_saga_without_pivot_full_rollback PASSED [ 96%]
tests/unit/test_pivot.py::TestPivotSagaIntegration::test_pivot_success_no_compensation PASSED [ 96%]
tests/unit/test_pivot.py::TestImperativeSagaPivot::test_add_step_with_pivot PASSED [ 97%]
tests/unit/test_pivot.py::TestMermaidPivotVisualization::test_step_info_pivot_fields PASSED [ 97%]
tests/unit/test_pivot.py::TestMermaidPivotVisualization::test_mermaid_generator_with_pivot_zones PASSED [ 97%]
tests/unit/test_pivot.py::TestMermaidPivotVisualization::test_mermaid_generator_with_tainted_steps PASSED [ 97%]
tests/unit/test_pivot.py::TestMermaidPivotVisualization::test_mermaid_generator_without_pivot_zones PASSED [ 97%]
tests/unit/test_pivot.py::TestMermaidPivotVisualization::test_mermaid_generator_no_pivots PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerDecorator::test_basic_trigger_attaches_metadata PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerDecorator::test_trigger_with_max_concurrent PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerDecorator::test_trigger_with_idempotency_key_string PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerDecorator::test_trigger_with_idempotency_key_callable PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerDecorator::test_trigger_with_extra_config PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerRegistry::test_register_and_get_triggers PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerRegistry::test_get_triggers_empty_source PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerRegistry::test_multiple_triggers_same_source PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerRegistry::test_get_all_registry PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestTriggerRegistry::test_clear_registry PASSED [ 97%]
tests/unit/triggers/test_triggers.py::TestSagaAutoRegistration::test_saga_with_trigger_auto_registers PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestSagaAutoRegistration::test_saga_with_multiple_triggers PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestSagaAutoRegistration::test_saga_without_trigger_does_not_register PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestTriggerEngine::test_fire_with_no_triggers_returns_empty PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestTriggerEngine::test_fire_calls_transformer PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestTriggerEngine::test_fire_skips_if_transformer_returns_none PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestTriggerEngine::test_fire_skips_if_transformer_returns_non_dict PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestTriggerEngine::test_fire_with_async_transformer PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestConcurrencyControl::test_concurrency_allows_within_limit PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestConcurrencyControl::test_concurrency_blocks_over_limit PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestConcurrencyControl::test_concurrency_allows_after_completion PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestIdempotency::test_idempotency_same_key_returns_same_id PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestIdempotency::test_idempotency_different_keys_create_different_sagas PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestIdempotency::test_idempotency_with_callable_key PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestIdempotency::test_idempotency_missing_key_field_generates_random_id PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestSagaPersistence::test_saga_persists_executing_state PASSED [ 98%]
tests/unit/triggers/test_triggers.py::TestSagaPersistence::test_saga_persists_completed_state PASSED [ 99%]
tests/unit/triggers/test_triggers.py::TestSagaPersistence::test_saga_persists_rolled_back_state_on_failure PASSED [ 99%]
tests/unit/triggers/test_triggers.py::TestEdgeCases::test_empty_payload PASSED [ 99%]
tests/unit/triggers/test_triggers.py::TestEdgeCases::test_saga_without_saga_name_attribute PASSED [ 99%]
tests/unit/triggers/test_triggers.py::TestEdgeCases::test_transformer_exception_handled PASSED [ 99%]
tests/unit/triggers/test_triggers.py::TestEdgeCases::test_multiple_sagas_for_same_source PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestCronScheduler::test_cron_trigger_decorator PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestCronScheduler::test_cron_trigger_with_timezone PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestCronScheduler::test_cron_scheduler_start_stop PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestCronScheduler::test_cron_scheduler_fires_events PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestCronScheduler::test_cron_scheduler_respects_schedule PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestBrokerIntegration::test_broker_trigger_decorator PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestBrokerIntegration::test_broker_consumer_processes_messages PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestBrokerIntegration::test_broker_consumer_filters_by_topic PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestBrokerIntegration::test_broker_consumer_with_existing_outbox_broker PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestMultipleSources::test_saga_with_multiple_sources PASSED [ 99%]
tests/unit/triggers/test_triggers_sources.py::TestMultipleSources::test_same_saga_triggered_from_different_sources PASSED [100%]

================================ tests coverage ================================
_______________ coverage: platform linux, python 3.13.5-final-0 ________________

Name                                            Stmts   Miss Branch BrPart  Cover   Missing
-------------------------------------------------------------------------------------------
sagaz/__main__.py                                   1      1      0      0     0%   1
sagaz/cli/examples.py                             131     15     44      6    86%   48-49, 63-66, 88->93, 95-99, 143, 150, 157, 179->exit, 196->199, 201
sagaz/cli/project.py                              134     21     44      9    82%   13-14, 24, 106-107, 108->113, 134->138, 162, 172, 179-180, 192->191, 220-222, 250-251, 259-260, 278-283
sagaz/cli/replay.py                               224     25     64      8    88%   23-25, 36, 156, 163, 165-166, 238, 305, 324, 374-390, 489
sagaz/core/compliance.py                           97      8     30      5    90%   95-96, 115, 145, 161, 173-175, 255->258
sagaz/core/config.py                              227      0     80      3    99%   156->160, 158->160, 175->exit
sagaz/core/context.py                             226     51     56      1    77%   31, 175-180, 186-217, 227-264, 267-286
sagaz/core/decorators.py                          356      0     92      6    99%   563->566, 880->892, 898->906, 912->922, 964->961, 966->961
sagaz/core/exceptions.py                           16      0      2      0   100%
sagaz/core/hooks.py                                59      0      4      0   100%
sagaz/core/listeners.py                           133      0     26      1    99%   194->exit
sagaz/core/logger.py                               12      0      4      0   100%
sagaz/core/replay.py                               82      0      2      0   100%
sagaz/core/saga.py                                540     11    110      4    98%   1066-1067, 1080, 1082, 1103-1104, 1126-1127, 1155-1157
sagaz/core/saga_replay.py                          61      1     10      1    97%   149
sagaz/core/time_travel.py                          65      0     16      0   100%
sagaz/core/types.py                                62      0      0      0   100%
sagaz/execution/graph.py                          242      0     52      1    99%   448->446
sagaz/execution/orchestrator.py                    42      0      2      0   100%
sagaz/execution/pivot.py                          115      0     26      1    99%   425->422
sagaz/execution/state_machine.py                   79      0     18      0   100%
sagaz/integrations/_base.py                        37      0      2      0   100%
sagaz/integrations/fastapi.py                      31      0      0      0   100%
sagaz/integrations/flask.py                        41      0      4      0   100%
sagaz/monitoring/logging.py                        73      0     10      0   100%
sagaz/monitoring/metrics.py                        28      0      6      1    97%   42->exit
sagaz/monitoring/prometheus.py                     47      0     14      0   100%
sagaz/monitoring/tracing.py                       138      0     44      0   100%
sagaz/outbox/brokers/base.py                       27      0      0      0   100%
sagaz/outbox/brokers/factory.py                    73      0     22      1    99%   50->49
sagaz/outbox/brokers/kafka.py                      52      0      2      0   100%
sagaz/outbox/brokers/memory.py                     22      0      4      0   100%
sagaz/outbox/brokers/rabbitmq.py                   43      0      0      0   100%
sagaz/outbox/brokers/redis.py                     121      0     22      1    99%   240->exit
sagaz/outbox/consumer_inbox.py                     37      0      2      0   100%
sagaz/outbox/optimistic_publisher.py               41      0      4      0   100%
sagaz/outbox/state_machine.py                      54      0      6      0   100%
sagaz/outbox/types.py                              71      0      4      0   100%
sagaz/outbox/worker.py                            180      0     24      2    99%   329->338, 410->414
sagaz/storage/backends/memory/outbox.py            83      0     18      0   100%
sagaz/storage/backends/memory/saga.py             111      0     26      1    99%   154->exit
sagaz/storage/backends/memory_snapshot.py          66     12     18      2    79%   57, 66-81, 104->107, 129, 148-150
sagaz/storage/backends/postgresql/outbox.py        30      0      2      0   100%
sagaz/storage/backends/postgresql/saga.py         141      0     28      2    99%   155->exit, 406->409
sagaz/storage/backends/postgresql/snapshot.py     101     69     16      1    28%   106-111, 115-130, 134-137, 166-182, 188-220, 226-245, 251-267, 271-282, 286-300, 304-307, 330-347, 364-381, 399-401, 416-418, 422-423, 427
sagaz/storage/backends/redis/outbox.py            232      0     58     11    96%   301->304, 329->327, 399->397, 405->397, 408->394, 444->442, 451->442, 482->480, 498->501, 535->528, 614->612
sagaz/storage/backends/redis/saga.py              188      0     40      3    99%   248->246, 349->352, 438->exit
sagaz/storage/backends/redis/snapshot.py          164    123     44      1    21%   35, 70-79, 83-92, 96, 100, 104, 108, 112-117, 121-126, 130-151, 158-167, 173-194, 200-219, 225-239, 243-258, 269, 273-289, 296-304, 310-324, 328-331, 335-336, 340
sagaz/storage/backends/s3/snapshot.py             218    177     52      1    16%   27, 35, 76-88, 92-104, 108, 112, 116, 120-125, 129-134, 138-170, 174-198, 207-218, 224-249, 255-277, 283-304, 308-325, 331-353, 362-387, 391-412, 416-426, 432-461, 465-468, 472-473, 477
sagaz/storage/backends/sqlite/outbox.py           141      3     16      3    96%   103-104, 143->exit, 414
sagaz/storage/backends/sqlite/saga.py             134      3     32      5    95%   112-113, 143->146, 275->287, 276->275, 311
sagaz/storage/base.py                              31      0      4      1    97%   193->196
sagaz/storage/core/base.py                         32      0      2      1    97%   115->117
sagaz/storage/core/connection.py                   88      0     18      2    98%   175->178, 233->236
sagaz/storage/core/errors.py                       53      0      4      0   100%
sagaz/storage/core/health.py                       46      0      0      0   100%
sagaz/storage/core/serialization.py                97      1     54      1    99%   72
sagaz/storage/factory.py                           77      0     14      0   100%
sagaz/storage/interfaces/outbox.py                 29      0      0      0   100%
sagaz/storage/interfaces/saga.py                   38      0      4      0   100%
sagaz/storage/interfaces/snapshot.py                6      0      0      0   100%
sagaz/storage/manager.py                          212     23     42      0    91%   360-365, 369-374, 378-383, 408-413, 417-422
sagaz/storage/memory.py                             2      0      0      0   100%
sagaz/storage/postgresql.py                         2      0      0      0   100%
sagaz/storage/redis.py                              2      0      0      0   100%
sagaz/storage/transfer/service.py                 191      0     44      1    99%   396->exit
sagaz/strategies/base.py                            8      0      0      0   100%
sagaz/strategies/fail_fast.py                      36      0     16      1    98%   78->77
sagaz/strategies/fail_fast_grace.py                42      0     14      1    98%   93->92
sagaz/strategies/wait_all.py                       19      0      8      0   100%
sagaz/triggers/decorators.py                       17      0      0      0   100%
sagaz/triggers/engine.py                          114      3     30      2    97%   86, 99-102
sagaz/triggers/registry.py                         26      0      2      0   100%
sagaz/visualization/mermaid.py                    339      0    158      2    99%   562->564, 564->566
-------------------------------------------------------------------------------------------
TOTAL                                            7136    547   1616     93    91%
Coverage HTML written to dir htmlcov
========= 1606 passed, 11 skipped, 81 deselected in 139.01s (0:02:19) ==========
